<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Stephen's Blog - Should Rails Developers be Database Developers</title>
      <meta name="viewport" content="width=device-width">

      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/stylesheets/syntax.css">

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/stylesheets/main.css">

      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/stylesheets/responsive.css">

      <!-- Google Fonts -->
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <script src="javascripts/respond.js"></script>
      <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <![endif]-->
      <!-- [if lt IE 8]>
      <link rel="stylesheet" href="stylesheets/ie.css">
      <![endif]-->
       
       <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
       <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-9203088421896530"
     crossorigin="anonymous"></script>
  </head>
  <body>
    <div class="site">
      <div class="sidebar" id="sidebar">
        <div class="header">
          <h1 class="title"><a href="/"><img id="logo" src="http://emomonkey.github.io/images/portrait.jpg"></a></h1>
          <span class="tagline">Personal Blog</span>
          <span class="tagline"><a href="/nasa" >NASA page</a></span>
        </div>
        <div class="posts">
          <ul class="posts-list">
            
              <li class="post-link">
                <a class="post-title" href="/2020/05/11/Elasticsearch/">
                  <span class="post-date">11 May 2020</span>
                  A Database Developer's First Impression on ElasticSearch
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2019/07/26/HackerRank1/">
                  <span class="post-date">26 Jul 2019</span>
                  Migratory Ranks Javascript solution
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2019/04/24/PICam/">
                  <span class="post-date">24 Apr 2019</span>
                  Raspberry PI Window Mounted Camera Module with Motion
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2019/04/08/InkyPHAT/">
                  <span class="post-date">08 Apr 2019</span>
                  Pimorini Inky PHAT with Google Calender
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2017/08/04/Completed-Darksouls2/">
                  <span class="post-date">04 Aug 2017</span>
                  Dark Souls 2 Completed ...
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2017/04/22/SharePlaylist/">
                  <span class="post-date">22 Apr 2017</span>
                  SpottyMail Share with your Crush
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2017/04/22/SpottyMail/">
                  <span class="post-date">22 Apr 2017</span>
                  SpottyMail
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/12/01/EBS-Validation/">
                  <span class="post-date">01 Dec 2016</span>
                  EBS Validation in Concurrent Jobs
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/11/30/ConcurrentRequest-BULK/">
                  <span class="post-date">30 Nov 2016</span>
                  How to Wait for a Concurrent Request To Complete
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/09/12/Oracle-BULK/">
                  <span class="post-date">12 Sep 2016</span>
                  How to Structure BULK Collect FORALL while maintaining the Program Flow
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/09/12/EBS-PDF/">
                  <span class="post-date">12 Sep 2016</span>
                  Oracle PDFMerger API does not support PDF format beyond 2004
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/09/07/Completed-Darksouls/">
                  <span class="post-date">07 Sep 2016</span>
                  Dark Souls Completed after almost 2 years
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2016/04/13/PropertyTrackerFindings/">
                  <span class="post-date">13 Apr 2016</span>
                  Property Price Changes in Northern Ireland 2016 versus 2015 ?
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/12/09/IsaacSpectrum/">
                  <span class="post-date">09 Dec 2015</span>
                  Is Binding of Isaac a Remake of Atic Atac ?
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/07/20/price/">
                  <span class="post-date">20 Jul 2015</span>
                  Property Tracker Northern Ireland Latest Update
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/07/20/drone/">
                  <span class="post-date">20 Jul 2015</span>
                  Flying my Syma X5C with my son
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/05/17/rubyrailslocal/">
                  <span class="post-date">17 May 2015</span>
                  Using Ruby on Rails in Offline Environment
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/03/03/high-charts-interactive-grids/">
                  <span class="post-date">03 Mar 2015</span>
                  High Charts Interactive Grids
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2015/02/19/using-highcharts-in-ruby-on-rails-in-headless-mode/">
                  <span class="post-date">19 Feb 2015</span>
                  Using Highcharts in  Ruby on Rails in Headless Mode
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2015/02/11/effective-use-of-concurrent-sidekiq-workers/">
                  <span class="post-date">11 Feb 2015</span>
                  Effective Use of Concurrent Sidekiq Workers
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/01/26/improvements-that-could-be-made-to-my-northern-ireland-property-tracking-website/">
                  <span class="post-date">26 Jan 2015</span>
                  Improvements that could be made to my Northern Ireland Property Tracking Website
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/01/20/using-whenever-gem-to-overcome-postgres-limitations/">
                  <span class="post-date">20 Jan 2015</span>
                  Using Whenever GEM to overcome Postgres limitations
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/01/15/developing-a-web-scraping-class-in-ruby/">
                  <span class="post-date">15 Jan 2015</span>
                  Developing a Web Scraping Class in Ruby
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2015/01/13/should-rails-developers-be-database-developers/">
                  <span class="post-date">13 Jan 2015</span>
                  Should Rails Developers be Database Developers
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2015/01/11/tracking-property-in-northern-ireland-ruby-on-rails/">
                  <span class="post-date">11 Jan 2015</span>
                  Tracking Property in Northern Ireland (Ruby on Rails)
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014/04/24/most-talked-about-tag/">
                  <span class="post-date">24 Apr 2014</span>
                  Most talked about #tag
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014/03/10/spring-boot-versus-spring-2-5-annotation-versus-pre-2-5/">
                  <span class="post-date">10 Mar 2014</span>
                  Spring Boot versus Spring 2.5 annotation versus Pre 2.5
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2014/03/06/new-project/">
                  <span class="post-date">06 Mar 2014</span>
                  New Project
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2014/02/18/twitterwhatsuphome-nodejs-app-listing-twitter-updates-and-weather-for-your-location/">
                  <span class="post-date">18 Feb 2014</span>
                  TwitterWhatsUpHome :- Nodejs App listing Twitter Updates and Weather for your Location
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2013/11/12/raspberrypispyintranet/">
                  <span class="post-date">12 Nov 2013</span>
                  RaspberryPISpyIntranet
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2013/05/18/atmega-gertboard-controlled-servo-via-serial-input/">
                  <span class="post-date">18 May 2013</span>
                  ATMega Gertboard controlled servo via serial input
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013/04/28/gertboard/">
                  <span class="post-date">28 Apr 2013</span>
                  Gertboard
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013/04/07/53/">
                  <span class="post-date">07 Apr 2013</span>
                  I have been working on an ASP.Net MVC
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013/04/01/windows-azure-versus-herokucloudfoundry/">
                  <span class="post-date">01 Apr 2013</span>
                  Windows Azure Versus Heroku/Cloudfoundry
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2013/03/17/post-on-asp-net-mvc-4/">
                  <span class="post-date">17 Mar 2013</span>
                  $.Post on ASP.Net MVC 4
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/2012/12/27/good-bye-ruby-on-rails-and-hello-mvvm-asp-net/">
                  <span class="post-date">27 Dec 2012</span>
                  Good bye Ruby on Rails  and Hello MVVM ASP.Net
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/10/21/crunchbang-install-tip/">
                  <span class="post-date">21 Oct 2012</span>
                  Crunchbang install tip
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/10/05/reusable-pages-apex-4-1/">
                  <span class="post-date">05 Oct 2012</span>
                  Reusable pages apex 4.1
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/09/21/crunchbang-or/">
                  <span class="post-date">21 Sep 2012</span>
                  Crunchbang or #!
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/08/02/development-environment/">
                  <span class="post-date">02 Aug 2012</span>
                  Development environment
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/07/23/apex-4-1-versus-ruby-on-rails/">
                  <span class="post-date">23 Jul 2012</span>
                  Apex 4.1 versus Ruby on Rails
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/04/11/loading-that-xsd-file/">
                  <span class="post-date">11 Apr 2012</span>
                  Loading that xsd file
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/04/06/jdeveloper-and-xsd/">
                  <span class="post-date">06 Apr 2012</span>
                  Jdeveloper and xsd
                </a>
              </li>
            
              <li class="post-link">
                <a class="post-title" href="/programming/2012/03/10/jdeveloper/">
                  <span class="post-date">10 Mar 2012</span>
                  Jdeveloper
                </a>
              </li>
            
          </ul>
          
          

        </div>
      </div> 
       <body>
        <div class="content" id="home">
        <div id="sidebar-button">
          <img src="/images/sidebar-button.png">
        </div>
        <div id="post-info">
         
          <div id="info-container">
            <h1 id="title">Should Rails Developers be Database Developers</h1>
            <span id="date">13 Jan 2015</span>
          </div>
        </div>
      
        <div class="post">
          <p>One of the things that I noticed in most of the getting start with Rails books that they seemed determined in teaching you how to work with the database purely through ActiveRecord. ActiveRecord contains alot of analytical functions such as sum or count though these are very limiting compared to what you can in pure SQL especially with a database as powerful as Postgres which contains many of the features of Oracle from windows functions (analytical functions in Oracle) and materialised views.</p>
<p>Take a look at the following piece of SQL</p>
<blockquote><p>SELECT cntyvol.COUNTY, cntyvol.YEAR, cntyvol.MONTH, cntyvol.VOLPC, cntyvol.created_at,soldvol.prcsold, prcchg.MONTH_PRICE_DIFF, row_number() OVER () id<br />
FROM<br />
(SELECT vcnty.county, vcnty.year, vcnty.month, ROUND((vcnty.volsum / tvol.volsum) * 100,2) VOLPC, created_at<br />
FROM<br />
(SELECT<br />
COUNTY,<br />
YEAR,<br />
MONTH,<br />
historic_analyses.created_at,<br />
ROUND(SUM(resultvalue), 2) volsum<br />
FROM historic_analyses, search_params sp, search_types st<br />
WHERE search_types_id = st.id AND search_params_id = sp.id<br />
AND st.searchtext = 'Volume Summary Property Types'<br />
GROUP BY COUNTY, YEAR, MONTH, historic_analyses.created_at<br />
) vcnty,<br />
(SELECT<br />
YEAR,<br />
MONTH,<br />
ROUND(SUM(resultvalue), 2) volsum<br />
FROM historic_analyses, search_params sp, search_types st<br />
WHERE search_types_id = st.id AND search_params_id = sp.id<br />
AND st.searchtext = 'Volume Summary Property Types'<br />
GROUP BY YEAR, MONTH<br />
) tvol<br />
WHERE tvol.year = vcnty.year<br />
AND vcnty.month = tvol.month) cntyvol,<br />
(SELECT volv.county, volv.year, volv.month, ROUND( (soldval /volsum * 100) ,2) prcsold<br />
FROM<br />
(<br />
SELECT<br />
COUNTY,<br />
YEAR,<br />
MONTH,<br />
ROUND(SUM(resultvalue), 2) volsum<br />
FROM historic_analyses, search_params sp, search_types st<br />
WHERE search_types_id = st.id AND search_params_id = sp.id<br />
AND st.searchtext = 'Volume Summary Property Types'<br />
GROUP BY COUNTY, YEAR, MONTH<br />
) volv LEFT JOIN<br />
(<br />
SELECT<br />
COUNTY,<br />
YEAR,<br />
MONTH,<br />
ROUND(SUM(resultvalue), 2) soldval<br />
FROM historic_analyses, search_params sp, search_types st<br />
WHERE search_types_id = st.id AND search_params_id = sp.id<br />
AND st.searchtext = 'Sold Summary Prop Type'<br />
GROUP BY COUNTY, YEAR, MONTH<br />
ORDER BY COUNTY, YEAR, MONTH DESC<br />
) soldv ON soldv.county = volv.county AND soldv.year = volv.year AND soldv.month = volv.month<br />
) soldvol,<br />
(<br />
SELECT COUNTY, YEAR, MONTH,MONTH_PRICE_DIFF<br />
FROM (<br />
SELECT<br />
COUNTY,<br />
YEAR,<br />
MONTH,<br />
coalesce(round((AVERAGEVAL - LAG(AVERAGEVAL, 1)<br />
OVER (PARTITION BY county<br />
ORDER BY year, month)), 2), 0) MONTH_PRICE_DIFF,<br />
valtime<br />
FROM (<br />
SELECT<br />
COUNTY,<br />
YEAR,<br />
MONTH,<br />
ROUND(AVG(resultvalue), 2) AVERAGEVAL,<br />
MAX(year || trim(to_char(month, '09')))<br />
OVER (PARTITION BY county) valtime<br />
FROM historic_analyses, search_params sp<br />
WHERE search_types_id = 5 AND search_params_id = sp.id<br />
GROUP BY COUNTY, YEAR, MONTH<br />
ORDER BY COUNTY, YEAR, MONTH DESC<br />
) a<br />
) perc<br />
WHERE valtime = year|| trim(to_char(month,'09'))<br />
) prcchg<br />
WHERE soldvol.county = cntyvol.county AND soldvol.year = cntyvol.year<br />
AND soldvol.month = cntyvol.month AND prcchg.county = cntyvol.county AND prcchg.month = cntyvol.month<br />
AND prcchg.year = cntyvol.year)</p></blockquote>
<p>Developing this in ActiveRecord would have been very time consuming and involved alot of lines of code considering ActiveRecord's sum function only operates on one group by at a time, ActiveRecord did prove it's worth when used as part of the web scraping code where database interaction is limited to inserts and updates as shown below</p>
<blockquote><p>propertysite <span class="pl-k">=</span> <span class="pl-s3">PropertySite</span>.create(<span class="pl-c1">:title</span> =&gt; spage[<span class="pl-s1"><span class="pl-pds">"</span>itmtitle<span class="pl-pds">"</span></span>], <span class="pl-c1">:propertytype</span> =&gt; spage[<span class="pl-s1"><span class="pl-pds">"</span>type<span class="pl-pds">"</span></span>], <span class="pl-c1">:beds</span> =&gt; sbeds.to_i, <span class="pl-c1">:searchtext</span> =&gt; <span class="pl-vo">@searchinput</span>, <span class="pl-c1">:status</span> =&gt; spage[<span class="pl-s1"><span class="pl-pds">"</span>status<span class="pl-pds">"</span></span>], <span class="pl-c1">:lastdatescanned</span> =&gt; <span class="pl-s3">DateTime</span>.now )</p></blockquote>
<p>Ruby on Rails applications are scaffolded and run as part of SQlite and all the tutorials focus on ActiveRecord which can lead developers down the wrong path by ignoring the powerful syntax they have available with SQL. Creating Database Independent code is not a good idea as the chances of your system moving from SQLlite to Postgres to MySQL over it's lifetime as slim,</p>
<p>It would be better if some of the books or Rails Blogs focused on Database Development as well as focusing 100 Percent on ActiveRecord.</p>

        </div>
        <div class="colophon">
          <p>
            <span id="pub-date">Published on 13 Jan 2015</span> <span class="separator">&bull;</span>
            <span id="social">Find me on <a href="">Twitter</a>!</span>
          </p>
        </div>
      </div>
       </body>
     
       
        <div class="footer">
          <span id="footer-links">
                <a href="http://emomonkey.github.io" class="footer-link">Home</a><span class="separator">&bull;</span>
                <a href="https://github.com/emomonkey" class="footer-link">View On GitHub</a><span class="separator">&bull;</span>
                <a href="https://uk.linkedin.com/pub/stephen-emo/60/308/54b" class="footer-link">LinkedIn</a><span class="separator">&bull;</span>
          </span>
          
        </div>

        
      </div>

        

    </div>
    <script src="/javascripts/responsive.js" type="text/javascript"></script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script>
      <script type="text/javascript">
        try {
          var pageTracker = _gat._getTracker("UA-97629936-1");
        pageTracker._trackPageview();
        } catch(err) {}
</script>
  </body>
</html>
