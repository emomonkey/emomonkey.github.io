<!DOCTYPE html>
<html>
  <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Stephen's Blog - How to Structure BULK Collect FORALL while maintaining the Program Flow</title>
      <meta name="viewport" content="width=device-width">

      <!-- syntax highlighting CSS -->
      <link rel="stylesheet" href="/stylesheets/syntax.css">

      <!-- Custom CSS -->
      <link rel="stylesheet" href="/stylesheets/main.css">

      <!-- Responsive CSS -->
      <link rel="stylesheet" href="/stylesheets/responsive.css">

      <!-- Google Fonts -->
      <link href='http://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,700' rel='stylesheet' type='text/css'>
      <link href='http://fonts.googleapis.com/css?family=Raleway:300,400,700' rel='stylesheet' type='text/css'>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
      <script src="javascripts/respond.js"></script>
      <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
      <![endif]-->
      <!-- [if lt IE 8]>
      <link rel="stylesheet" href="stylesheets/ie.css">
      <![endif]-->
       
       <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
  </head>
  <body>
    <div class="site">
      <div class="sidebar" id="sidebar">
        <div class="header">
          <h1 class="title"><a href="/"><img id="logo" src="http://emomonkey.github.io/images/portrait.jpg"></a></h1>
          <span class="tagline">Personal Blog</span>
          <span class="tagline"><a href="/nasa" >NASA page</a></span>
        </div>
        <div class="posts">
          <ul class="posts-list">
            
          </ul>
          
          <div class="pagination">
            
              <span class="previous">Previous</span>
            
            <span class="page_number ">
              Page:  of 
            </span>
            
              <span class="next ">Next</span>
            
          </div>

        </div>
      </div> 
       <body>
        <div class="content" id="home">
        <div id="sidebar-button">
          <img src="/images/sidebar-button.png">
        </div>
        <div id="post-info">
         
          <div id="info-container">
            <h1 id="title">How to Structure BULK Collect FORALL while maintaining the Program Flow</h1>
            <span id="date">12 Sep 2016</span>
          </div>
        </div>
      
        <div class="post">
          <p>I have been working on a number of concurrent requests for Oracle EBS and checking to see how I can improve the performance of some of the existing routines which do numerous updates and inserts. Not it is suggested that the updates be split up into BULK Collect and FORALL statements however this does ignore the fact that sometimes routines need to carry out calculations and checks in a certain order. It is not simply a matter of doing all the updates in one go so to keep the flow of the program I updated the routine to instead store the updates and inserts to various tables in a global temporary tables. Then this global temporary table could be processed in a step by step basis as required.</p>

<p>So the declaration of the global temporary table was combined with the BULK Collect and FORALL in the below manner</p>
<div class="highlight"><pre><code class="language-sql" data-lang="sql">       <span class="n">tmp_tb</span> <span class="k">IS</span> <span class="k">TABLE</span> <span class="k">OF</span> <span class="n">tmp_table</span><span class="o">%</span><span class="n">ROWTYPE</span> <span class="k">INDEX</span> <span class="k">BY</span> <span class="n">BINARY_INTEGER</span><span class="p">;</span>

       <span class="n">l_tmp</span> <span class="n">tmp_table</span><span class="p">;</span>

       <span class="k">CURSOR</span> <span class="n">update_cur</span>
       <span class="k">IS</span>
       <span class="k">SELECT</span> <span class="o">*</span>
       <span class="k">FROM</span> <span class="n">tmp_table</span>
       <span class="k">WHERE</span> <span class="k">table_name</span> <span class="o">=</span> <span class="s1">'A_TABLE'</span> <span class="k">AND</span> <span class="n">action</span> <span class="o">=</span> <span class="s1">'UPDATE;

       BEGIN
        OPEN update_cur;
        LOOP
        FETCH update_cur BULK COLLECT INTO l_tmp LIMIT 200;
        EXIT WHEN l_tmp.COUNT = 0;

             FORALL i IN l_tmp.first .. l_tmp.last
               UPDATE A_TABLE SET field1=l_tmp(i).field1 WHERE field2=l_tmp(i).field2;


        END LOOP;
        CLOSE update_cur;

       END

</span></code></pre></div>
<p>The above logic can be used and parse the changes into the database while the population of the Global Temporary Table can be done in such a way that it mirrors the flow of the original program which dotted updates and inserts behind checks and calculations. This allows us to update the program while not disturbing the flow of the program but allowing it to process it&#39;s updates and inserts efficiently.</p>

        </div>
        <div class="colophon">
          <p>
            <span id="pub-date">Published on 12 Sep 2016</span> <span class="separator">&bull;</span>
            <span id="social">Find me on <a href="">Twitter</a>!</span>
          </p>
        </div>
      </div>
       </body>
     
       
        <div class="footer">
          <span id="footer-links">
                <a href="http://emomonkey.github.io" class="footer-link">Home</a><span class="separator">&bull;</span>
                <a href="https://github.com/emomonkey" class="footer-link">View On GitHub</a><span class="separator">&bull;</span>
                <a href="https://uk.linkedin.com/pub/stephen-emo/60/308/54b" class="footer-link">LinkedIn</a><span class="separator">&bull;</span>
          </span>
          <div class="google-ads">
                <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
                <!-- Programming Blog Ads -->
                 <ins class="adsbygoogle"
                      style="display:block"
                      data-ad-client="ca-pub-9203088421896530"
                      data-ad-slot="3590526208"
                      data-ad-format="auto"></ins>
                <script>
                (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>
        </div>

        
      </div>

        

    </div>
    <script src="/javascripts/responsive.js" type="text/javascript"></script>
    <script type="text/javascript">
        var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
        document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
      </script>
      <script type="text/javascript">
        try {
          var pageTracker = _gat._getTracker("UA-97629936-1");
        pageTracker._trackPageview();
        } catch(err) {}
</script>
  </body>
</html>
